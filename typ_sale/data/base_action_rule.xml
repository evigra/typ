<?xml version='1.0' encoding='UTF-8'?>
<odoo noupdate="0">
    <record id="automated_action_sell_below_minimum_margin" model="base.automation">
        <field name="name">Sell below the minimum margin</field>
        <field name="model_id" ref="sale.model_sale_order_line"/>
        <field name="active" eval="False"/>
        <field name="sequence">5</field>
        <field name="trigger">on_create_or_write</field>
        <field name="state">code</field>
        <field name="code">
            if not record.move_ids:
              record.check_margin()
        </field>
    </record>
    <record id="automated_action_description_sale_order_line" model="base.automation">
        <field name="name">Add default code in description of sale order line</field>
        <field name="model_id" ref="sale.model_sale_order_line"/>
        <field name="active" eval="True"/>
        <field name="sequence">5</field>
        <field name="trigger">on_change</field>
        <field name="on_change_fields">product_id</field>
        <field name="state">code</field>
        <field name="code">
code = record.product_customer_code
if code:
    name = "%s (%s)" % (record.name, (record.product_id.product_tmpl_id.default_code or record.product_id.default_code))
    record.update({'name' : name})
        </field>
    </record>
</odoo>
