<openerp>
<data>

<!-- Add fields to Invoice -->
<!--         <record id="view_invoice_form_inherit_stocks_send_dm3" model="ir.ui.view">
            <field name="name">account.invoice.form.dm3.stocks</field>
            <field name="model">account.invoice</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="account.invoice_form"/>
            <field name="arch" type="xml">
                <field name="date_invoice" position="after">
                    <field name="invoice_from_albaran" invisible="1"/>
                </field>
                <notebook position="inside">
                    <page string="Stocks Product Management" attrs="{'invisible':[('invoice_from_albaran','=',False)]}">
                        <separator string="Stocks Picking Send" />
                        <newline/>
                        <field name="picking_invoice_ids" readonly="1" nolabel="1"/>
                        <group col="4">
                            <field name="product_shipped" readonly="1"/>
                        </group>
                            <separator string="Product Remaining by Deliver" attrs="{'invisible':[('product_shipped','=',True)]}"/>
                            <newline />
                        <group colspan="4">
                            <field name="invoice_remaining_ids" nolabel="1" readonly="1" attrs="{'invisible':[('product_shipped','=',True)]}" >
                                  <tree editable="bottom">
                                    <field name="product_id" on_change="on_change_product_id(product_id, product_uom)" />
                                    <field name="product_uom" />
                                    <field name="product_uom_qty" on_change="on_change_values(product_id, product_uom_qty, price_unit)"/>
                                  </tree>
                            </field>
                        </group>
                    </page>
                </notebook>
            </field>
        </record> -->

        <record id="view_invoice_refund_form_inhrt_typ_" model="ir.ui.view">
            <field name="name">account.invoice.form.dm3.refund</field>
            <field name="model">account.invoice</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="account.invoice_form"/>
            <field name="arch" type="xml">
                <!-- <field name="date_due" position="after">
                    <field name="not_rel_invoice" attrs="{'invisible':[('type', '!=', 'out_refund')]}"/>
                    <field name="refund_invoice_id" attrs="{'invisible':[('type', '!=', 'out_refund')],'required':[('type', '=', 'out_refund'),('not_rel_invoice','=',False)]}" domain="[('type','=','out_invoice'),('partner_id','=',partner_id)]"/>
                </field> -->

                <field name="move_id" position="before">
                    <field name="rel_invoice" attrs="{'invisible':[('type', '!=', 'out_refund')]}"/>
                    <field name="invoice_customer_refund_id" attrs="{'invisible':[('type', '!=', 'out_invoice')]}" />
                    <field name="invoice_customer_id" attrs="{'invisible':['|',('type', '!=', 'out_refund'),('rel_invoice','=',False)],'required':[('type', '=', 'out_refund'),('rel_invoice','=',True)]}" domain="[('type','=','out_invoice'),('partner_id','=',partner_id)]"/>
                </field>
                <field name="user_id" position="after">
                    <field name="reasigned_sale" groups="argil_typ_comissions.group_argil_comissions" />
                    <field name="user_reasigned_id" groups="argil_typ_comissions.group_argil_comissions" attrs="{'invisible':[('reasigned_sale','=',False)],'required':[('reasigned_sale','=',True)]}"/>
                </field>
                <field name="date_due" position="after" >
                    <field name="date_payment_real" />
                    <field name="period_payment_real" />
                </field>
            </field>
        </record>

        <record id="view_invoice_refund_tree_inherit_stocks_send_dm3" model="ir.ui.view">
            <field name="name">account.invoice.tree.dm3.refund</field>
            <field name="model">account.invoice</field>
            <field name="type">tree</field>
            <field name="inherit_id" ref="account.invoice_tree"/>
            <field name="arch" type="xml">
                <field name="date_due" position="after" >
                    <field name="date_payment_real" />
                    <field name="period_payment_real" invisible="1"/>
                    <field name="invoice_customer_refund_id" />
                </field>
            </field>
        </record>

        <record id="view_invoice_refund_search_inherit_stocks_send_dm3" model="ir.ui.view">
            <field name="name">account.invoice.search.dm3.refund</field>
            <field name="model">account.invoice</field>
            <field name="type">search</field>
            <field name="inherit_id" ref="account.view_account_invoice_filter"/>
            <field name="arch" type="xml">
                <group expand="0" string="Group By..." position="inside">
                    <filter string="Periodo Liquidacion Factura" icon="terp-go-month" domain="[]" context="{'group_by':'period_payment_real'}"/>

                </group>
            </field>
        </record>

    <!--  VISTAS PARA LAS LINEAS DE LAS FACTURAS, PARA ANALIZAR MEJOR -->
    
    <record id="view_invoice_lines_inherit" model="ir.ui.view">
            <field name="name">account.invoice.line.inherit</field>
            <field name="model">account.invoice.line</field>
            <field name="type">tree</field>
            <field name="inherit_id" ref="account.view_invoice_line_tree"/>
            <field name="arch" type="xml">
                <!-- <xpath expr="//tree[@string='Invoice Line']" position="attributes">
                    <attribute name="editable">bottom</attribute>
                </xpath> -->
                <field name="name" position="before">
                    <field name="product_id" />
                </field>
                <field name="price_subtotal" position="after" >
                    <field name="invoice_id" string="Factura No."/>
                    <field name="invoice_type" />
                    <field name="partner_id"/>
                    <field name="payment_term_partner"/>
                    <field name="category_product_id" />
                    <field name="currency_id" />
                    <field name="currency_tc" />
                    <field name="price_cost" />
                    <field name="margin_amount" />
                    <field name="margin_percentage" />
                    <field name="invoice_customer_refund_id" />
                    <field name="user_invoice_rel" />
                    <field name="user_reasigned_invoice_id" />
                    <field name="date_invoice" />
                    <field name="date_due" />
                    <field name="date_payment_real_invoice" />
                    <field name="period_payment_real_invoice" />
                    <field name="company_id" />
                    <field name="state_invoice" />
                </field>
            </field>
        </record>
    <record id="invoice_lines_filter" model="ir.ui.view">
          <field name="name">account.invoice.line.filter</field>
          <field name="model">account.invoice.line</field>
          <field name="type">search</field>
          <field name="priority" eval="5"/>
          <field name="arch" type="xml">
            <search string="Filtros de Lineas de Facturas">
                <field name="name"/>
                <field name="account_id"/>
                <field name="uos_id" />
                <field name="invoice_id" />
                <field name="invoice_type" />
                <field name="user_invoice_rel" />
                <field name="user_reasigned_invoice_id" />
                <field name="date_payment_real_invoice" />
                <field name="period_payment_real_invoice" />
                <field name="state_invoice" />
                <filter string="Vendedor no Admin" domain="[('user_invoice_rel','!=',1)]" context=""/>
                <filter string="Borrador" domain="[('state_invoice','not in',('open','paid'))]" context=""/>
                <filter string="Abierto" domain="[('state_invoice','=','open')]" context=""/>
                <filter string="Pagado" domain="[('state_invoice','=','paid')]" context=""/>
                <filter string="Factura Cliente" domain="[('invoice_type','=','out_invoice')]" context=""/>
                <filter string="Nota Cr. Cliente" domain="[('invoice_type','=','out_refund')]" context=""/>
                <filter string="Factura Proveedor" domain="[('invoice_type','=','in_invoice')]" context=""/>
                <filter string="Nota Cr. Proveedor" domain="[('invoice_type','=','in_refund')]" context=""/>
                <group expand="0" string="Agrupar por...">
                    <filter string="Factura" domain="[]" context="{'group_by':'invoice_id'}"/>
                    <filter string="Categoria Producto" domain="[]" context="{'group_by':'category_product_id'}"/>
                    <filter string="Vendedor" domain="[]" context="{'group_by':'user_invoice_rel'}"/>
                    <filter string="Vendedor Asignado" domain="[]" context="{'group_by':'user_reasigned_invoice_id'}"/>
                    <filter string="Fecha Pagado" domain="[]" context="{'group_by':'date_payment_real_invoice'}"/>
                    <filter string="Periodo Pagado" domain="[]" context="{'group_by':'period_payment_real_invoice'}"/>
                    <filter string="Estado Factura" domain="[]" context="{'group_by':'state_invoice'}"/>
                    
                </group> 
            </search>
          </field>
        </record>
    <record model="ir.actions.act_window" id="actions_invoices_line">
            <field name="name">Lineas de Facturas</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.invoice.line</field>
            <!-- <field name="search_view_id" ref="invoice_lines_filter"/> -->
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
        </record>
            <!--====================================MENU================================-->

        <menuitem name="Analisis Manual de Facturas" id="menu_comissions_analisis" parent="menu_reports_pssoft" sequence="10"/>
        <menuitem action="actions_invoices_line" id="menu_invoice_lines" parent="menu_comissions_analisis" sequence="1"/>

</data>
</openerp>
