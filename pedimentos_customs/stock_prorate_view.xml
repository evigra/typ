<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <!-- Creando la Vista Asistente -->

         <record id="wizard_prorate_pedimento_form" model="ir.ui.view">
            <field name="name">Asignar Pedimentos</field>
            <field name="model">wizard.prorate.pedimento</field>
            <field name="arch" type="xml">
              <form string="Asistente para Asignar Pedimentos" version="7.0">
                    <sheet>
                       <group col="4" >
                            <field name="load_lines" on_change="on_change_lines(load_lines,pedimento_id,active_prorate)" invisible="1"/>
                            <field name="active_prorate" invisible="1" />
                       </group>
                        <separator string="Selecciona el Pedimento y pulsa Asignar" />
                       <group >
                            <field name="pedimento_id" on_change="on_change_lines(load_lines,pedimento_id,active_prorate)"/>
                        </group>
                        <field name="line_ids" >
                            <tree string="Productos/Pedimentos" editable="bottom" >
                                <field name="product_id" />
                                <field name="pedimento_id" />
                                <field name="qty" />
                                <field name="stock_prorate_line" invisible="1"/>
                            </tree>
                        </field>
                       
                    </sheet>
                  <footer>
                    <center>
                      <button name="assign_pedimentos" string="Asignar" icon="gtk-execute" type="object" class="oe_highlight"/>
                      รณ
                      <button string="Cancelar" class="oe_link" special="cancel"/>
                    </center>
                  </footer>
             </form>
            </field>
        </record>


        <act_window name="Asignar Pedimentos"
            res_model="wizard.prorate.pedimento"
            src_model="stock.prorate"
            key2="client_action_multi"
            multi="True"
            view_mode="form"
            view_type="form"
            target="new"
            id="action_wizard_prorate_pedimento"/>

        <!-- HERENCIA LINEAS DEL PRORATEO -->

        <record model="ir.ui.view" id="inhrt_stock_prorate_form_view">
            <field name="name">inherit.stock.prorate.form.view</field>
            <field name="model">stock.prorate</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="argil_purchase_prorate.stock_prorate_form"/>
            <field name="arch" type="xml">
              <field name="state" position="before">
                <!-- <button name="%(action_wizard_prorate_pedimento)d" string="Asignar Pedimentos" icon="gtk-execute" type="action" attrs="{'invisible':[('state','not in',('draft','confirm')),('pedimento_assign','=',True)]}"/> -->
                <button name="%(action_wizard_prorate_pedimento)d" string="Asignar Pedimentos" icon="gtk-execute" type="action" attrs="{'invisible':[('state','not in',('draft','confirm'))]}"/>
              </field>
              <field name="expense_account_move_id" position="after">
                <field name="pedimento_assign" />
              </field>
              <field name="currency_id" position="before">
                <field name="prorate_ref" />
              </field>
              <field name="stock_prorate_ids" position="before">
                <div align="right">
                  <button name="refresh_lines" string="Actualizar Calculos" type="object" icon="gtk-execute"  class="oe_link" attrs="{'invisible':[('state','=','done')]}"/>
                </div>
              </field>
            </field>
        </record>

        <record model="ir.ui.view" id="inhrt_stock_prorate_stock_line_tree_view">
            <field name="name">inherit.stock.prorate.stock.line.form.view</field>
            <field name="model">stock.prorate.stock.line</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="argil_purchase_prorate.stock_prorate_stock_line_tree"/>
            <field name="arch" type="xml">
              <field name="prodlot_id" position="before">
                <field name="pedimento_id" 
                            context="{'default_product_id':product_id}" 
                            domain="[('product_id','=',product_id)]"/>
              </field>
            </field>
        </record>

        <record model="ir.ui.view" id="inhrt_stock_prorate_stock_tree_view">
            <field name="name">inherit.stock.prorate.stock.tree.view</field>
            <field name="model">stock.prorate</field>
            <field name="type">tree</field>
            <field name="inherit_id" ref="argil_purchase_prorate.stock_prorate_tree"/>
            <field name="arch" type="xml">
              <field name="name" position="after">
                  <field name="prorate_ref" />
              </field>
            </field>
        </record>

        <record model="ir.ui.view" id="inhrt_stock_prorate_stock_filter_view">
            <field name="name">inherit.stock.prorate.stock.filter.view</field>
            <field name="model">stock.prorate</field>
            <field name="type">search</field>
            <field name="inherit_id" ref="argil_purchase_prorate.stock_prorate_search"/>
            <field name="arch" type="xml">
              <field name="date" position="before">
                    <field name="prorate_ref"/>
              </field>
            </field>
        </record>

    </data>
</openerp>  
        
