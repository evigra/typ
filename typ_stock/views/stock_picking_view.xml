<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_origin_picking_internal_search_inherit" model="ir.ui.view">
        <field name="name">origin.picking.internal.search.inherit</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_internal_search"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_id']" position="before">
                <field name="origin"/>
            </xpath>
        </field>
    </record>
    <record id="view_move_picking_tree_inherit" model="ir.ui.view">
        <field name="name">move.picking.tree.inherit</field>
        <field name="model">stock.move</field>
        <field name="inherit_id" ref="stock.view_move_picking_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='product_id']" position="after">
                <field name="date_expected"/>
            </xpath>
            <xpath expr="//field[@name='state']" position="after">
                <field name="price_unit" groups="typ_sale.res_group_cost_audit"/>
            </xpath>
        </field>
    </record>
    <record id="view_typ_picking_button_cancel_inherit" model="ir.ui.view">
        <field name="name">typ.picking.button.cancel</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="arch" type="xml">
           <button name="action_cancel" position="attributes">
                <attribute name="groups" translation="off">typ_stock.res_group_cancel_picking</attribute>
           </button>
        </field>
    </record>
    <record id="view_move_picking_form_inherit" model="ir.ui.view">
        <field name="name">move.picking.form.inherit</field>
        <field name="model">stock.move</field>
        <field name="inherit_id" ref="stock.view_move_picking_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='product_id']" position="attributes">
                <attribute name="attrs" translation="off">{'readonly': [('state', '!=', 'draft')]}</attribute>
            </xpath>
            <xpath expr="//field[@name='product_uom_qty']" position="attributes">
                <attribute name="attrs" translation="off">{'readonly': [('state', '!=', 'draft')]}</attribute>
            </xpath>
            <xpath expr="//field[@name='name']" position="attributes">
                <attribute name="attrs" translation="off">{'readonly': [('state', '!=', 'draft')]}</attribute>
            </xpath>
            <xpath expr="//field[@name='product_uom']" position="attributes">
                <attribute name="attrs" translation="off">{'readonly': [('state', '!=', 'draft')]}</attribute>
            </xpath>
            <xpath expr="//field[@name='location_id']" position="attributes">
                <attribute name="attrs" translation="off">{'readonly': [('state', '!=', 'draft')]}</attribute>
            </xpath>
            <xpath expr="//field[@name='location_dest_id']" position="attributes">
                <attribute name="attrs" translation="off">{'readonly': [('state', '!=', 'draft')]}</attribute>
            </xpath>
            <xpath expr="//field[@name='location_dest_id']" position="after">
                <field name="move_orig_ids" readonly="1"/>
            </xpath>
        </field>
    </record>
    <record id="view_stock_picking_form_inherit" model="ir.ui.view">
        <field name="name">stock.picking.form.inherit</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="arch" type="xml">
            <field name="origin" position="before">
                <field name="picking_shipment_date"/>
            </field>
            <xpath expr="//field[@name='origin']" position="after">
                <field name="number_landing"/>
            </xpath>
            <xpath expr="//field[@name='backorder_id']" position="after">
                <field name="invoiced" readonly="1"/>
            </xpath>
            <xpath expr="//button[@name='button_validate']" position="after">
                <button type="object" name="action_confirm_trafic" string="shipped ok"  attrs="
                    {'invisible':[('state','in',('draft','cancel','done'))]}
                    " groups="purchase.group_purchase_manager"/>
            </xpath>
            <xpath expr="//button[@name='%(stock.act_stock_return_picking)d']" position="attributes">
                <attribute name="groups" translation="off">typ_stock.res_group_reverse_transfer</attribute>
            </xpath>
            <field name="partner_id" position="attributes">
                <attribute name="attrs" translation="off">{'readonly': [('state', '=', 'assigned')]}</attribute>
            </field>
            <xpath expr="//field[@name='move_lines']//field[@name='product_uom_qty']" position="before">
                <field name="shipment_date"/>
                <field name="date_expected"/>
            </xpath>
            <xpath expr="//field[@name='location_dest_id']" position="after">
                <field name="requirements_for_warranty" attrs="{'invisible': [('is_warranty', '=', False)], 'readonly': True}"/>
                <field name="is_warranty" invisible="1"/>
                <field name="responsible_for_warranty" attrs="{ 'invisible': [('is_warranty', '=', False)], 'required': [('is_warranty', '=', True)]}"/>
            </xpath>
        </field>
    </record>

    <record id="view_requirements_for_warranty_readonly" model="ir.ui.view">
        <field name="name">stock.picking.form.inherit</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="typ_stock.view_stock_picking_form_inherit"/>
        <field name="groups_id" eval="[(6, 0, [ref('typ_stock.group_stock_validation_warranty_transfer')])]"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='requirements_for_warranty']" position="attributes">
                <attribute name="readonly">False</attribute>
            </xpath>
        </field>
    </record>

    <record id="view_stock_picking_tree_inherit" model="ir.ui.view">
        <field name="name">stock.picking.tree.inherit</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.vpicktree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='date']" position="after">
                <field name="create_date"/>
                <field name="picking_shipment_date"/>
                <field name="invoiced" invisible="1"/>
            </xpath>
            <xpath expr="//field[@name='origin']" position="before">
                <field name="date_done"/>
            </xpath>
            <xpath expr="//field[@name='origin']" position="after">
                <field name="number_landing"/>
            </xpath>
            <xpath expr="//tree" position="attributes">
                <attribute name="decoration-danger" translation="off">not invoiced and state not in ('cancel', 'done') and scheduled_date &lt; current_date</attribute>
                <attribute name="decoration-success" translation="off">invoiced and picking_shipment_date &lt;= current_date and current_date &lt;= scheduled_date</attribute>
                <attribute name="decoration-warning" translation="off">state not in ('cancel','done') and picking_shipment_date &lt; current_date and scheduled_date &lt; current_date</attribute>
            </xpath>
            </field>
    </record>
    <!-- Hide create button to a group -->
    <record id="stock_picking_hide_button_form" model="ir.ui.view">
        <field name="name">stock.picking.hide.button.form</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="groups_id" eval="[(6, 0, [ref('typ_stock.res_group_can_not_create_picking')])]"/>
        <field name="arch" type="xml">
            <xpath expr="//form" position="attributes">
                <attribute name="create" translation="off">false</attribute>
            </xpath>
        </field>
    </record>
    <record id="stock_picking_hide_button_tree" model="ir.ui.view">
        <field name="name">stock.picking.hide_button.tree</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.vpicktree"/>
        <field name="groups_id" eval="[(6, 0, [ref('typ_stock.res_group_can_not_create_picking')])]"/>
        <field name="arch" type="xml">
            <xpath expr="//tree" position="attributes">
                 <attribute name="create" translation="off">false</attribute>
            </xpath>
        </field>
    </record>
    <record id="stock_picking_hide_button_validation_group" model="ir.ui.view">
        <field name="name">stock.picking.hide.button.form</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="groups_id" eval="[(6, 0, [ref('typ_stock.group_stock_button_validation_transfer')])]"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='button_validate']" position="attributes">
                <attribute name="invisible" translation="off">True</attribute>
            </xpath>
        </field>
    </record>
</odoo>
