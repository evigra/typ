<?xml version='1.0' encoding='UTF-8'?>
<openerp>
    <data noupdate="1">

        <record id="server_action_propagate_picking_transfer" model="ir.actions.server">
            <field name="name">Propagate picking transfer</field>
            <field name="model_id" model="ir.model" search="[('model', '=', 'stock.move')]"/>
            <field name="state">code</field>
            <field name="code">object.propagate_picking_transfer()</field>
        </record>

        <record id="server_action_validate_picking_negative" model="ir.actions.server">
            <field name="name">Validate picking negative</field>
            <field name="model_id" model="ir.model" search="[('model', '=', 'stock.move')]"/>
            <field name="state">code</field>
            <field name="code">object.validate_picking_negative()</field>
        </record>

        <record id="server_action_validate_move_internal" model="ir.actions.server">
            <field name="name">Validate move internal locations</field>
            <field name="model_id" model="ir.model" search="[('model', '=', 'stock.picking')]"/>
            <field name="state">code</field>
            <field name="code">object.validate_move_internal()</field>
        </record>

        <record id="server_action_verify_user_scrap" model="ir.actions.server">
            <field name="name">Verify user scrap</field>
            <field name="model_id" model="ir.model" search="[('model', '=', 'stock.move')]"/>
            <field name="state">code</field>
            <field name="code">object.verify_user_scrap()</field>
        </record>

        <record id="server_action_validate_return_customer" model="ir.actions.server">
            <field name="name">Validate return of customer</field>
            <field name="model_id" model="ir.model" search="[('model', '=', 'stock.picking')]"/>
            <field name="state">code</field>
            <field name="code">object.validate_return_customer()</field>
        </record>

        <record id="server_action_procurement_migration" model="ir.actions.server">
            <field name="name">Validation procurement in migration</field>
            <field name="model_id" model="ir.model" search="[('model', '=', 'procurement.order')]"/>
            <field name="state">code</field>
            <field name="code">for procurement in model.browse(context.get('active_ids')):
    if procurement.state == 'running' and not procurement.rule_id:
            procurement.cancel()
    if procurement.purchase_id and procurement.purchase_id.state == 'cancel':
            procurement.cancel()
    if procurement.purchase_id and procurement.purchase_id.state == 'done':
            procurement.check()
            </field>
        </record>

        <record id="server_action_procurement_cancel" model="ir.actions.server">
            <field name="name">Action procurement cancel</field>
            <field name="model_id" model="ir.model" search="[('model', '=', 'procurement.order')]"/>
            <field name="state">code</field>
            <field name="code">
for proc in model.browse(context.get('active_ids')):
    if proc.state == 'exception' and (not proc.purchase_id or proc.purchase_id.state == 'cancel') and proc.rule_id.action == 'buy':
            proc.with_context(dict(context, not_delete_purchase_line=True)).cancel()
            </field>
        </record>
    </data>
</openerp>
