<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <template id="assets_common_l10n_mx_edi_typ" inherit_id="web.report_assets_pdf">
        <xpath expr="." position="inside">
            <link
                href="/l10n_mx_edi/static/src/scss/report.scss"
                rel="stylesheet"
                type="text/scss"
            />
        </xpath>
    </template>

    <!-- QWeb Reports -->
    <record id="account.account_invoices" model="ir.actions.report">
        <field name="paperformat_id" ref="typ.typ_paperformat_invoice_letter" />
    </record>

    <record id="account.account_invoices_without_payment" model="ir.actions.report">
        <field name="paperformat_id" ref="typ.typ_paperformat_invoice_letter" />
    </record>

    <template id="report_invoice_document" inherit_id="account.report_invoice_document">
        <xpath expr="//t[@t-call='web.external_layout']" position="attributes">
            <attribute name="t-call">typ.external_layout</attribute>
        </xpath>
        <xpath expr="//div[hasclass('row')]" position="replace">
        </xpath>
        <xpath expr="//h2" position="replace">
            <!-- Global variables -->
            <t t-set="cfdi_vals" t-value="o._l10n_mx_edi_decode_cfdi()"/>
            <t t-set="cfdi_node" t-value="cfdi_vals.get('cfdi_node')"/>
            <t t-set="is_cfdi_signed" t-value="bool(o._get_l10n_mx_edi_signed_edi_document())"/>
            <div class="row">
                <div class="col-3" style="margin: 0px; padding: 0px;">
                    <img t-if="o.company_id.logo" t-att-src="'data:image/png;base64,%s' % to_text(o.company_id.logo)" style="max-height: 60px;"/>
                </div>
                <div class="offset-3 col-6 text-right">
                    <div class="row" style="font-size: 12;">
                        <div class="col-4 text-center bg-primary" style="border-top-left-radius: 0.4em; padding-top: 0.0em;">
                            <t t-if="o.move_type == 'out_invoice'">
                                <span t-if="o.state in ['open', 'paid']">Invoice</span>
                                <span t-elif="o.state == 'draft'">Draft Invoice</span>
                                <span t-elif="o.state == 'cancel'">Cancelled Invoice</span>
                            </t>
                            <span t-elif="o.move_type == 'out_refund'">Credit Note</span>
                            <span t-elif="o.move_type == 'in_refund'">Vendor Credit Note</span>
                            <span t-elif="o.move_type == 'in_invoice'">Vendor Bill</span>
                        </div>
                        <div class="col-8 text-center bg-primary" style="border-top-right-radius: 0.4em; padding-top: 0.0em;">
                            <span>Document Date</span>
                        </div>
                    </div>
                    <div class="row" style="border: 2px solid #deeff5; border-bottom-left-radius: 0.4em; border-bottom-right-radius: 0.4em;">
                        <div class="col-4 text-center" style="padding-top: 0.0em; border-right: 2px solid #deeff5;">
                            <h4 style="color:red;">
                                <t>
                                    <strong t-esc="o.name" />
                                </t>
                            </h4>
                        </div>
                        <div class="col-8 text-center" style="padding-top: 1.0em; font-size: 10;">
                            <t t-if="is_cfdi_signed">
                                <t t-set="date" t-value="cfdi_vals.get('emission_date_str')" />
                                <span t-esc="time.strftime('%d/%m/%Y %H:%M:%S', time.strptime(date, '%Y-%m-%d %H:%M:%S')) or o.invoice_date"/>
                            </t>
                            <t t-else="">
                                <span t-esc="o.invoice_date" />
                            </t>
                        </div>
                    </div>
                </div>
            </div>
            <t t-if="o.l10n_mx_edi_cfdi_request in ('on_invoice', 'on_refund') and not is_cfdi_signed and o.edi_state != 'cancelled'">
                <div t-attf-class="btn-danger #{'btn' if report_type != 'html' else ''}">
                    <h1>A signature of this invoice is required, but it is not signed.</h1>
                </div>
            </t>
            <div class="row" style="padding-top: 0.5em; font-size: 12;">
                <div class="col-5" style="padding-left: 0.0em; padding-right: 0.2em;">
                    <div class="text-center bg-primary" style="border-top-t-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                        <span>Client Reference</span>
                    </div>
                </div>
                <div class="col-4" style="padding-right: 0.2em; padding-left: 0.2em;">
                    <div class="text-center bg-primary" style="border-top-right-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                        <span>Fiscal Regime</span>
                    </div>
                </div>
                <div class="col-3" style="padding-right: 0.0em; padding-left: 0.2em;">
                    <div class="text-center bg-primary" style="border-top-right-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                        <span>Payment Term</span>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-5" style="padding-left: 0.0em; padding-right: 0.2em;">
                    <div class="text-center" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em; font-size: 10;">
                        <span t-esc="o.name" />
                    </div>
                </div>
                <div class="col-4" style="padding-right: 0.2em; padding-left: 0.2em;">
                    <div class="text-center" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em; font-size: 10;" >
                        <t t-if="is_cfdi_signed">
                            <span t-esc="cfdi_vals.get('fiscal_regime')" />
                        </t>
                    </div>
                </div>
                <div class="col-3" style="padding-right: 0.0em; padding-left: 0.2em;">
                    <div class="text-center" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em; font-size: 10;">
                        <span t-field="o.invoice_payment_term_id" />
                    </div>
                </div>
            </div>
            <div class="row" style="padding-top: 0.5em; font-size: 12;">
                <div class="col-4" style="padding-right: 0.2em; padding-left: 0.0em;">
                    <div class="text-center bg-primary" style="border-top-right-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                        <span>Issuer</span>
                    </div>
                </div>
                <div class="col-4" style="padding-right: 0.0em; padding-left: 0.2em;">
                    <div class="text-center bg-primary" style="border-top-right-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                        <span>Customer</span>
                    </div>
                </div>
                <div class="col-4" style="padding-right: 0.0em; padding-left: 0.2em;">
                    <div class="text-center bg-primary" style="border-top-right-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                        <span>Issued at</span>
                    </div>
                </div>
            </div>
            <div class="row" style="font-size: 10;">
                <div class="col-4" style="padding-right: 0.2em; padding-left: 0.0em;">
                    <div class="text-left" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em;">
                        <div>
                            <t t-if="is_cfdi_signed">
                                <strong t-esc="cfdi_node.Emisor.get('Nombre', '')" />
                            </t>
                            <t t-else="">
                                <strong t-esc="o.company_id.name" />
                            </t>
                        </div>
                        <div>
                            <span t-esc="o.company_id.street" />
                            <br />
                            <span t-esc="o.company_id.l10n_mx_edi_colony" />
                            <span t-esc="o.company_id.zip" />
                            <br />
                            <span t-esc="o.company_id.l10n_mx_edi_locality" />
                            <br />
                            <span t-esc="o.company_id.city" />
                            <span t-esc="o.company_id.state_id.name" />
                            <span t-esc="o.company_id.country_id.name" />
                        </div>
                        <div>
                            <strong t-esc="('RFC. %s') % o.l10n_mx_edi_cfdi_supplier_rfc"/>
                        </div>
                    </div>
                </div>
                <div class="col-4" style="padding-right: 0.0em; padding-left: 0.2em;">
                    <div class="text-center" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em;">
                        <div>
                            <t t-if="is_cfdi_signed">
                                <strong t-esc="cfdi_node.Receptor.get('Nombre', '')" />
                            </t>
                            <t t-else="">
                                <strong t-esc="o.partner_id.name" />
                            </t>
                        </div>
                        <div>
                            <span t-esc="o.partner_id.street" />
                            <br />
                            <span t-esc="o.partner_id.l10n_mx_edi_colony" />
                            <span t-esc="o.partner_id.zip" />
                            <br />
                            <span t-esc="o.partner_id.l10n_mx_edi_locality" />
                            <br />
                            <span t-esc="o.partner_id.city" />
                            <span t-esc="o.partner_id.state_id.name" />
                            <span t-esc="o.partner_id.country_id.name" />
                        </div>
                        <br />
                        <div>
                            <strong t-esc="('RFC. %s') % o.l10n_mx_edi_cfdi_customer_rfc"/>
                        </div>
                    </div>
                </div>
                <div class="col-4" style="padding-right: 0.0em; padding-left: 0.2em;">
                    <div class="text-right" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em;">
                        <div>
                            <t t-if="is_cfdi_signed">
                                <strong t-esc="cfdi_node.Emisor.get('Nombre', '')" />
                            </t>
                            <t t-else="">
                                <strong t-esc="o.company_id.name" />
                            </t>
                        </div>
                        <div>
                            <span t-esc="o.journal_id.l10n_mx_address_issued_id.street"/>
                            <br />
                            <span t-esc="o.journal_id.l10n_mx_address_issued_id.l10n_mx_edi_colony"/>
                            <span t-esc="o.journal_id.l10n_mx_address_issued_id.zip"/>
                            <br />
                            <span t-esc="o.journal_id.l10n_mx_address_issued_id.l10n_mx_edi_locality"/>
                            <br />
                            <span t-esc="o.journal_id.l10n_mx_address_issued_id.city"/>
                            <span t-esc="o.journal_id.l10n_mx_address_issued_id.state_id.name"/>
                            <span t-esc="o.journal_id.l10n_mx_address_issued_id.country_id.name"/>
                        </div>
                        <div>
                            <span t-esc="o.journal_id.l10n_mx_address_issued_id.phone"/>
                        </div>
                        <br />
                        <br />
                    </div>
                </div>
            </div>
        </xpath>
        <xpath expr="//table" position="replace">
            <table class="table table-striped" style="font-size:15px; border-collapse: collapse; padding-top: 0.5em;">
                <thead>
                    <tr>
                        <th class="text-center bg primary">Quantity</th>
                        <t t-if="is_cfdi_signed">
                            <th class="text-center bg-primary">Unit</th>
                            <th class="text-center bg-primary">SAT Key</th>
                        </t>
                        <th class="text-center bg-primary">Description</th>
                        <th class="text-center bg-primary">Unit Price</th>
                        <th class="text-center bg-primary">Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <t t-foreach="o.invoice_line_ids" t-as="l">
                        <tr class="text-center">
                            <td class="col-1 text-right">
                                <span t-field="l.quantity"/>
                            </td>
                            <td class="col-1 text-left" t-if="is_cfdi_signed">
                                <span t-field="l.product_uom_id.unspsc_code_id.code"/>
                            </td>
                            <td class="col-1 text-left" t-if="is_cfdi_signed">
                                <span t-field="l.product_id.unspsc_code_id.code"/>
                            </td>
                            <td class="col-5 text-left">
                                <span t-field="l.name" />
                                <t t-foreach="l.mapped('sale_line_ids.move_ids.move_line_ids.lot_id')" t-as="lot">
                                    <br />
                                    <t>(SN: <span t-esc="lot.name" />)</t>
                                </t>
                                <t t-if="l.l10n_mx_edi_customs_number">
                                    <br />
                                    <i>Customs:</i>
                                    <ul>
                                        <t t-foreach="l.l10n_mx_edi_customs_number.split(',') if l.l10n_mx_edi_customs_number else []" t-as="pedimento">
                                            <li><span t-esc="pedimento" /></li>
                                        </t>
                                    </ul>
                                </t>
                            </td>
                            <td class="col-2 text-right">
                                <span t-field="l.price_unit"/>
                            </td>
                            <td class="col-2 text-right" id="subtotal">
                                <span t-field="l.price_subtotal" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                            </td>
                        </tr>
                    </t>
                </tbody>
            </table>
        </xpath>
        <xpath expr="//div[hasclass('clearfix')]" position="replace">
            <div id="total" class="row">
                <div class="row offset-9 col-3">
                    <table class="col-12" style="font-size:15px">
                        <tr>
                            <th class="text-left" style="border-top: solid 1.5px #5689bc;">
                                <span>Sub Total</span>
                            </th>
                            <td class="text-right" style="border-top: solid 1.5px #5689bc;">
                                <span t-field="o.amount_untaxed" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                            </td>
                        </tr>
                        <t t-foreach="o.amount_by_group" t-as="amount_by_group">
                            <tr>
                                <t t-if="len(o.line_ids.filtered(lambda line: line.tax_line_id)) in [0, 1] and o.amount_untaxed == amount_by_group[2]">
                                    <td class="text-left" style="border-top: solid 1.5px #5689bc;">
                                        <span t-esc="amount_by_group[0]" />
                                    </td>
                                    <td class="text-right" style="border-top: solid 1.5px #5689bc;">
                                        <span t-esc="amount_by_group[3]" />
                                    </td>
                                </t>
                                <t t-else="">
                                    <td class="text-left" style="border-top: solid 1.5px #5689bc;">
                                        <span t-esc="amount_by_group[0]" />
                                        <span>&amp;nbsp;<span>on</span>
                                            <t t-esc="amount_by_group[4]" />
                                        </span>
                                    </td>
                                    <td class="text-right" style="border-top: solid 1.5px #5689bc;">
                                        <span t-esc="amount_by_group[3]" />
                                    </td>
                                </t>
                            </tr>
                        </t>
                        <tr align="left">
                            <th class="text-left" style="border-top: solid 1.5px #5689bc;">
                                <b><span>Total</span></b>
                            </th>
                            <td class="text-right" align="right" style="border-top: solid 1.5px #5689bc;">
                                <b><span t-field="o.amount_total" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/></b>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="row" style="font-size: 10;">
                <div class="col-12">
                    <span>Amount In Letters</span>
                </div>
                <div class="col-12 text-center">
                    <span t-esc="o._l10n_mx_edi_cfdi_amount_to_text()"/>
                </div>
                <div class="col-12">
                    <p class="text-center">Deadline for returns of 15 calendar days from delivery. Product must be presented in original packaging. Warranties: American 1 year parts and 5 years compressor equipment. Asia 1 year parts and compressor equipment. Does not apply to equipment with power failures or burns.</p>
                    <t t-if="o.narration">
                        <p><strong>Notes</strong>: <span t-esc="o.narration" /></p>
                    </t>
                </div>
            </div>
        </xpath>
        <xpath expr="//p[@t-if='o.invoice_payment_term_id']" position="replace">
            <t t-if="is_cfdi_signed">
                <div class="row" style="padding-top: 0.5em; font-size: 12;">
                    <div class="col-4" style="padding-left: 0.0em; padding-right: 0.2em;">
                        <div class="text-center bg-primary" style="border-top-right-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                            <span>Fiscal Folio</span>
                        </div>
                    </div>
                    <div class="col-4" style="padding-right: 0.2em; padding-left: 0.2em;">
                        <div class="text-center bg-primary" style="border-top-right-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                            <span>Account Last 4 Numbers</span>
                        </div>
                    </div>
                    <div class="col-4" style="padding-right: 0.0em; padding-left: 0.2em;">
                        <div class="text-center bg-primary" style="border-top-right-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                            <span>Issuer Certificate</span>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-4" style="padding-left: 0.0em; padding-right: 0.2em;">
                        <div class="text-center" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em; font-size: 10;">
                            <span t-esc="cfdi_vals.get('uuid', 'No identificado')" />
                        </div>
                    </div>
                    <div class="col-4" style="padding-right: 0.2em; padding-left: 0.2em;">
                        <div class="text-center" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em; font-size: 10;">
                            <t t-set="bank" t-value="o.partner_bank_id"/>
                            <span t-esc="bank and bank.acc_number[-4:] or 'No identificado'"/>
                        </div>
                    </div>
                    <div class="col-4" style="padding-right: 0.0em; padding-left: 0.2em;">
                        <div class="text-center" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em; font-size: 10;">
                            <span t-esc="cfdi_vals.get('certificate_number', 'No identificado')"/>
                        </div>
                    </div>
                </div>
                <div class="row" style="padding-top: 0.5em; font-size: 12;">
                    <div class="col-4" style="padding-left: 0.0em; padding-right: 0.2em;">
                        <div class="text-center bg-primary" style="border-top-right-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                            <span>Form of Payment</span>
                        </div>
                    </div>
                    <div class="col-4" style="padding-left: 0.2em; padding-right: 0.2em;">
                        <div class="text-center bg-primary" style="border-top-right-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                            <span>Date Stamp</span>
                        </div>
                    </div>
                    <div class="col-4" style="padding-left: 0.2em; padding-right: 0.0em;">
                        <div class="text-center bg-primary" style="border-top-right-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                            <span>SAT Certificate</span>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-4" style="padding-left: 0.0em; padding-right: 0.2em;">
                        <div class="text-center" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em; font-size: 10;">
                            <t t-if="o.l10n_mx_edi_payment_method_id">
                                <span t-esc="' - '.join([o.l10n_mx_edi_payment_method_id.code, o.l10n_mx_edi_payment_method_id.name])"/>
                            </t>
                        </div>
                    </div>
                    <div class="col-4" style="padding-left: 0.2em; padding-right: 0.2em;">
                        <div class="text-center" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em; font-size: 10;">
                            <span t-esc="time.strftime('%d/%m/%Y %H:%M:%S', time.strptime(cfdi_vals.get('stamp_date'), '%Y-%m-%d %H:%M:%S')) or 'No identificado'"/>
                        </div>
                    </div>
                    <div class="col-4" style="padding-left: 0.2em; padding-right: 0.0em;">
                        <div class="text-center" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em; font-size: 10;">
                            <span t-esc="cfdi_vals.get('certificate_sat_number', 'No identificado')"/>
                        </div>
                    </div>
                </div>
                <div class="row" style="padding-top: 0.5em; font-size: 12;">
                    <div class="col-6" style="padding-left: 0.0em; padding-right: 0.2em;">
                        <div class="text-center bg-primary" style="border-top-right-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                            <span>Payment Method</span>
                        </div>
                    </div>
                    <div class="col-6" style="padding-right: 0.2em; padding-left: 0.2em;">
                        <div class="text-center bg-primary" style="border-top-right-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                            <span>Use</span>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-6" style="padding-left: 0.0em; padding-right: 0.2em;">
                        <div class="text-center" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em; font-size: 10;">
                            <t t-set="payment_method" t-value="cfdi_vals.get('payment_method')"/>
                            <t t-if="payment_method == 'PPD'">
                                <span> PPD Payment in partials or deferred</span>
                            </t>
                            <t t-elif="payment_method == 'PUE'">
                                <span> PUE Payment in single exhibition</span>
                            </t>
                            <t t-else="">
                                <span t-esc="payment_method"/>
                            </t>
                        </div>
                    </div>
                    <div class="col-6" style="padding-left: 0.2em; padding-right: 0.2em;">
                        <div class="text-center" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em; font-size: 10;">
                            <t t-if="cfdi_vals.get('usage', False)">
                                <span t-esc="cfdi_vals['usage']"/> - <span t-field="o.l10n_mx_edi_usage"/>
                            </t>
                        </div>
                    </div>
                </div>
                <t t-if="o.l10n_mx_edi_origin">
                    <div class="row" style="padding-top: 0.5em; font-size: 12;">
                        <div class="col-6" style="padding-left: 0.0em; padding-right: 0.2em;">
                            <div class="text-center bg-primary" style="border-top-right-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                                <span>Related CFDI</span>
                            </div>
                        </div>
                        <div class="col-6" style="padding-right: 0.2em; padding-left: 0.2em;">
                            <div class="text-center bg-primary" style="border-top-right-radius: 0.4em; border-top-left-radius: 0.4em; padding-top: 0.0em;">
                                <span>Related type</span>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div>
                            <div class="col-6" style="padding-left: 0.0em; padding-right: 0.2em;">
                                <div class="text-center" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em; font-size: 10;">
                                    <span t-esc="o.l10n_mx_edi_origin[3:]" />
                                </div>
                            </div>
                            <div class="col-6" style="padding-left: 0.2em; padding-right: 0.2em;">
                                <div class="text-center" style="border-bottom-right-radius: 0.4em; border-bottom-left-radius: 0.4em; border: 2px solid #deeff5; padding-top: 0.0em; font-size: 10;">
                                    <t t-set="edi_origin" t-value="o.l10n_mx_edi_origin[:2]"/>
                                    <t t-if="edi_origin == '01'">
                                        <span>01 Credit note of related documents</span>
                                    </t>
                                    <t t-elif="edi_origin == '02'">
                                        <span>02 Debit note of related documents</span>
                                    </t>
                                    <t t-elif="edi_origin == '03'">
                                        <span>03 Return of merchandise on previous invoices or transfers</span>
                                    </t>
                                    <t t-elif="edi_origin == '04'">
                                        <span>04 Replacement of previous CFDI</span>
                                    </t>
                                    <t t-elif="edi_origin == '05'">
                                        <span>05 Transfers of goods previously invoiced</span>
                                    </t>
                                    <t t-elif="edi_origin == '06'">
                                        <span>06 Invoice generated by previous transfers</span>
                                    </t>
                                    <t t-elif="edi_origin == '07'">
                                        <span>07 CFDI by advance application</span>
                                    </t>
                                    <t t-elif="edi_origin == '08'">
                                        <span>08 Invoice generated by partial payments</span>
                                    </t>
                                    <t t-elif="edi_origin == '09'">
                                        <span>09 Invoice generated by deferred payments</span>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </div>
                </t>
                <div t-if="is_cfdi_signed" class="row img-rounded" id="complement" style="padding-top: 0.5em; border: 2px solid #deeff5;">
                        <div class="barcode col-3">
                            <t t-set="sello" t-value="cfdi_vals.get('sello', 'No identificado')"/>
                            <img alt="Barcode" t-att-src="'/report/barcode/?type=QR&amp;value=%s&amp;width=180&amp;height=180' % quote_plus(
                                'https://verificacfdi.facturaelectronica.sat.gob.mx/default.aspx?' + keep_query(
                                re=o.l10n_mx_edi_cfdi_supplier_rfc, rr=o.l10n_mx_edi_cfdi_customer_rfc,
                                tt='%.*f' % (o.currency_id.decimal_places, o.l10n_mx_edi_cfdi_amount), id=o.l10n_mx_edi_cfdi_uuid)
                                + '&amp;fe=%s' % quote_plus(sello[-8:], 'utf-8', 'strict', '=/').replace('%2B', '+'))"/>
                        </div>
                        <div class="complement-details col-9">
                            <div class="digital-stamp">
                                <span>Digital stamp of the emitter</span>
                            </div>
                            <div class="digital-stamp-content">
                                <span t-esc="sello"/>
                            </div>
                            <div class="digital-stamp">
                                <span>Digital stamp SAT</span>
                            </div>
                            <div class="digital-stamp-content">
                                <span t-esc="cfdi_vals.get('sello_sat', 'No identificado')"/>
                            </div>
                            <div class="digital-stamp">
                                <span
                                >Original chain complement of digital certification SAT</span>
                            </div>
                            <div class="digital-stamp-content">
                                <span class="nowrap" t-esc="cfdi_vals.get('cadena')" />
                            </div>
                            <div t-if="cfdi_node.Emisor.xpath('cfdi:ExpedidoEn', namespaces=cfdi_node.nsmap)" class="digital-stamp">
                                <span>Issued from</span>
                            </div>
                            <div t-if="cfdi_node.Emisor.xpath('cfdi:ExpedidoEn', namespaces=cfdi_node.nsmap)" class="digital-stamp-content">
                                <span t-esc="' | '.join([ '%s: %s' % (key, value) for key, value in cfdi_node.Emisor.ExpedidoEn.items()])"/>
                            </div>
                            <div class="digital-stamp">
                                <span>Extra Info</span>
                            </div>
                            <div class="digital-stamp-content">
                                <span>Emitter certificate:</span> <span t-esc="cfdi_vals.get('certificate_number')"/>
                                <span> | SAT Certificate:</span> <span t-esc="cfdi_vals.get('certificate_sat_number')"/>
                                <span> | Expedition place:</span> <span t-esc="cfdi_vals.get('expedition')"/>
                                <span> | Fiscal Regime:</span><span t-esc="cfdi_vals.get('fiscal_regime')"/>
                                <span> | Emission Date:</span> <span t-esc="cfdi_vals.get('emission_date_str')"/>
                                <span> | Certification Date:</span> <span t-esc="cfdi_vals.get('stamp_date')"/>
                                <span> | Fiscal Folio:</span> <span t-esc="cfdi_vals.get('uuid')"/>
                            </div>
                            <div class="digital-stamp-content text-center">
                                <strong>This document is a printed representation of a CFDI</strong>
                            </div>
                        </div>
                </div>
            </t>
        </xpath>
    </template>
    <record id="l10n_mx_edi.report_invoice_document_mx" model="ir.ui.view">
        <field name="active" eval='False' />
    </record>
</odoo>
